{% extends "layout.html" %}
{% block content %}
<div class="h1">{{ title }}</div>
<div class="form-group mb-4">
    <a class="btn btn-secondary" href="javascript:history.back()">Nazad</a>
</div>
<form action="" method="post">
    <legend class="form-control-legend" for="description">Opis popisne liste</legend>
    <textarea class="form-control mb-4" name="description" id="description" cols="100" rows="3"></textarea>
    <div class="form-group">
        <legend class="form-control-legend" for="data">Dodeljivanje prostorija popisnim komisijama</legend>
        <table id="data" border="1" class="table table-striped userlist">
            <thead>
                <tr>
                    <th>ID prostorije</th>
                    <th>Zgrada</th>
                    <th>Prostorija</th>
                    <th>Predsednik popisne komisija</th>
                </tr>
            </thead>
            <tbody>
                {% for room in rooms %}
                <tr>
                    <td>
                        <input class="form-control" type="text" value="{{room.id}}" name="room_id[]" readonly>
                    </td>
                    <td>
                        <input class="form-control" type="text" value="{{room.room_building.name}}" disabled>
                    </td>
                    <td>
                        <input class="form-control" type="text" value="{{room.dynamic_name}}" disabled>
                    </td>
                    <td>
                        <select class="form-select" id="" name="user_id[]">
                            <option value=""></option>
                            {% for user in users %}
                            <option value="{{user.id}}">{{ user.name }} {{ user.surname }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <button type="submit" class="btn btn-primary" id="createButton" disabled>Kreirajte</button>
</form>
{% endblock content%}

{% block scripts %}
<script>
    $(document).ready(function () {
        $("#data").DataTable({
            order: [[1, "asc"]],
            language: {
                url: "//cdn.datatables.net/plug-ins/1.12.1/i18n/sr-SP.json",
                stateSave: true
            },
            // lengthMenu: [100, 200, 400], // Postavljanje podrazumevanih vrednosti za prikazivanje
            paging: false, // Isključivanje paginacije
        });
        $('#add_item_rate, #add_item_category').select2({
            dropdownParent: $('#newItem'),
            placeholder: 'Izaberite opciju',
            allowClear: true,
            width: '100%',
            tags: false,
            closeOnSelect: true,
        });
        // Dodajte promenu događaja (change event) na sve select elemente sa klasom "form-select"
        $('.form-select').on('change', function () {
            // Proverite sve select elemente
            var allSelected = true;
            $('.form-select').each(function () {
                // Ako bilo koji od select elemenata nema vrednost, postavite allSelected na false
                if (!$(this).val()) {
                    allSelected = false;
                    return false; // Prekini petlju ako je pronađen neizabran element
                }
            });

            // Omogući ili onemogući dugme "Kreirajte" u zavisnosti od vrednosti allSelected
            $('#createButton').prop('disabled', !allSelected);
        });
    });
</script>
{% endblock %}